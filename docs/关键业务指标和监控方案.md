# å…³é”®ä¸šåŠ¡æŒ‡æ ‡å’Œç›‘æ§æ–¹æ¡ˆ

**ç›®æ ‡**: ä¸ºIoTä¸­é—´ä»¶å»ºç«‹å®Œæ•´çš„ä¸šåŠ¡ç›‘æ§å’ŒæŒ‡æ ‡ä½“ç³»  
**æ›´æ–°æ—¶é—´**: 2025-01-13

## ğŸ¯ ç›‘æ§ç›®æ ‡

### ä¸šåŠ¡ç›®æ ‡
- **æœåŠ¡è´¨é‡**: ç¡®ä¿ç¬¬ä¸‰æ–¹å¹³å°APIæœåŠ¡ç¨³å®šå¯é 
- **è¿è¥æ•ˆç‡**: ç›‘æ§è®¾å¤‡çŠ¶æ€å’Œå……ç”µä¸šåŠ¡å¥åº·åº¦
- **æ•…éšœé¢„é˜²**: æå‰å‘ç°å’Œé¢„è­¦æ½œåœ¨é—®é¢˜
- **æ•°æ®é©±åŠ¨**: ä¸ºè¿è¥å†³ç­–æä¾›æ•°æ®æ”¯æ’‘

### æŠ€æœ¯ç›®æ ‡
- **ç³»ç»Ÿæ€§èƒ½**: ç›‘æ§APIå“åº”æ—¶é—´å’Œååé‡
- **èµ„æºä½¿ç”¨**: ç›‘æ§ç³»ç»Ÿèµ„æºå’Œæ•°æ®åº“æ€§èƒ½
- **é”™è¯¯è·Ÿè¸ª**: è¿½è¸ªå’Œåˆ†æç³»ç»Ÿé”™è¯¯å’Œå¼‚å¸¸
- **å®¹é‡è§„åˆ’**: é¢„æµ‹å’Œè§„åˆ’ç³»ç»Ÿå®¹é‡éœ€æ±‚

## ğŸ“Š æ ¸å¿ƒä¸šåŠ¡æŒ‡æ ‡

### 1. è®¾å¤‡çŠ¶æ€æŒ‡æ ‡
```yaml
è®¾å¤‡åœ¨çº¿æŒ‡æ ‡:
  - è®¾å¤‡æ€»æ•°: device_total_count
  - åœ¨çº¿è®¾å¤‡æ•°: device_online_count  
  - ç¦»çº¿è®¾å¤‡æ•°: device_offline_count
  - è®¾å¤‡åœ¨çº¿ç‡: device_online_rate (online_count / total_count)
  - è®¾å¤‡å¹³å‡åœ¨çº¿æ—¶é•¿: device_avg_uptime_hours

è®¾å¤‡æ€§èƒ½æŒ‡æ ‡:
  - è®¾å¤‡å“åº”æˆåŠŸç‡: device_response_success_rate
  - å¹³å‡å“åº”æ—¶é—´: device_avg_response_time_ms
  - å¿ƒè·³æˆåŠŸç‡: device_heartbeat_success_rate
  - åè®®é”™è¯¯ç‡: device_protocol_error_rate
  - é‡è¿æ¬¡æ•°: device_reconnection_count

è®¾å¤‡å¥åº·æŒ‡æ ‡:
  - è®¾å¤‡æ•…éšœæ•°: device_fault_count
  - è®¾å¤‡æ•…éšœç‡: device_fault_rate
  - ç»´æŠ¤ä¸­è®¾å¤‡æ•°: device_maintenance_count
  - è®¾å¤‡å¥åº·è¯„åˆ†: device_health_score (1-10åˆ†)
```

### 2. ç«¯å£ä½¿ç”¨æŒ‡æ ‡
```yaml
ç«¯å£çŠ¶æ€æŒ‡æ ‡:
  - ç«¯å£æ€»æ•°: port_total_count
  - ç©ºé—²ç«¯å£æ•°: port_idle_count
  - å……ç”µä¸­ç«¯å£æ•°: port_charging_count
  - æ•…éšœç«¯å£æ•°: port_fault_count
  - ç«¯å£åˆ©ç”¨ç‡: port_utilization_rate (charging_count / total_count)

ç«¯å£æ€§èƒ½æŒ‡æ ‡:
  - å¹³å‡å……ç”µæ—¶é•¿: port_avg_charging_duration_minutes
  - ç«¯å£å‘¨è½¬ç‡: port_turnover_rate (sessions_per_hour)
  - ç«¯å£å¯é æ€§: port_reliability_rate
  - å¹³å‡ç­‰å¾…æ—¶é—´: port_avg_wait_time_minutes
```

### 3. å……ç”µä¸šåŠ¡æŒ‡æ ‡
```yaml
å……ç”µä¼šè¯æŒ‡æ ‡:
  - ä»Šæ—¥å……ç”µæ¬¡æ•°: charging_sessions_today
  - å½“å‰è¿›è¡Œä¸­ä¼šè¯: charging_sessions_active
  - å……ç”µæˆåŠŸç‡: charging_success_rate
  - å……ç”µå¤±è´¥ç‡: charging_failure_rate
  - å¹³å‡ä¼šè¯æ—¶é•¿: charging_avg_session_duration_minutes

å……ç”µç”µé‡æŒ‡æ ‡:
  - ä»Šæ—¥ç”¨ç”µé‡: energy_consumed_today_kwh
  - å®æ—¶åŠŸç‡è¾“å‡º: power_output_current_kw
  - å¹³å‡åŠŸç‡: power_avg_kw
  - å³°å€¼åŠŸç‡: power_peak_kw
  - èƒ½æ•ˆæ¯”: energy_efficiency_ratio

å……ç”µæ”¶ç›ŠæŒ‡æ ‡:
  - ä»Šæ—¥å……ç”µæ”¶å…¥: revenue_today_yuan
  - å¹³å‡å®¢å•ä»·: revenue_avg_per_session_yuan
  - å•ä½ç”µé‡æ”¶å…¥: revenue_per_kwh_yuan
  - è®¾å¤‡æŠ•èµ„å›æŠ¥ç‡: device_roi_percentage
```

### 4. APIæœåŠ¡æŒ‡æ ‡
```yaml
APIæ€§èƒ½æŒ‡æ ‡:
  - APIæ€»è¯·æ±‚æ•°: api_requests_total
  - APIæˆåŠŸè¯·æ±‚æ•°: api_requests_success
  - APIæˆåŠŸç‡: api_success_rate
  - APIé”™è¯¯ç‡: api_error_rate
  - APIå¹³å‡å“åº”æ—¶é—´: api_avg_response_time_ms
  - API P95å“åº”æ—¶é—´: api_p95_response_time_ms
  - API P99å“åº”æ—¶é—´: api_p99_response_time_ms
  - API QPS: api_requests_per_second

APIé”™è¯¯æŒ‡æ ‡:
  - 4xxé”™è¯¯æ•°: api_client_errors_4xx
  - 5xxé”™è¯¯æ•°: api_server_errors_5xx
  - è¶…æ—¶è¯·æ±‚æ•°: api_timeout_requests
  - é™æµæ‹’ç»æ•°: api_rate_limit_rejections
  - è®¤è¯å¤±è´¥æ•°: api_auth_failures

ç¬¬ä¸‰æ–¹é›†æˆæŒ‡æ ‡:
  - äº‹ä»¶æ¨é€æˆåŠŸç‡: webhook_success_rate
  - äº‹ä»¶æ¨é€å»¶è¿Ÿ: webhook_avg_latency_ms
  - æ¨é€é‡è¯•æ¬¡æ•°: webhook_retry_count
  - æ¨é€å¤±è´¥æ•°: webhook_failure_count
```

### 5. ç³»ç»Ÿèµ„æºæŒ‡æ ‡
```yaml
ç³»ç»Ÿæ€§èƒ½æŒ‡æ ‡:
  - CPUä½¿ç”¨ç‡: system_cpu_usage_percent
  - å†…å­˜ä½¿ç”¨ç‡: system_memory_usage_percent
  - ç£ç›˜ä½¿ç”¨ç‡: system_disk_usage_percent
  - ç½‘ç»œå…¥æµé‡: system_network_in_mbps
  - ç½‘ç»œå‡ºæµé‡: system_network_out_mbps

æ•°æ®åº“æŒ‡æ ‡:
  - æ•°æ®åº“è¿æ¥æ•°: db_connections_active
  - æ•°æ®åº“è¿æ¥æ± ä½¿ç”¨ç‡: db_pool_usage_percent
  - å¹³å‡æŸ¥è¯¢æ—¶é—´: db_avg_query_time_ms
  - æ…¢æŸ¥è¯¢æ•°: db_slow_queries_count
  - æ•°æ®åº“ç¼“å­˜å‘½ä¸­ç‡: db_cache_hit_rate
  - æ•°æ®åº“å†™å…¥QPS: db_write_qps
  - æ•°æ®åº“è¯»å–QPS: db_read_qps

ç¼“å­˜æŒ‡æ ‡:
  - Rediså†…å­˜ä½¿ç”¨ç‡: redis_memory_usage_percent
  - Redisç¼“å­˜å‘½ä¸­ç‡: redis_cache_hit_rate
  - Redisè¿æ¥æ•°: redis_connections_count
  - Redisæ“ä½œQPS: redis_ops_per_second
```

## ğŸ“ˆ ç›‘æ§å®ç°æ–¹æ¡ˆ

### 1. PrometheusæŒ‡æ ‡æ”¶é›†
```go
// internal/metrics/business_metrics.go
package metrics

import (
    "github.com/prometheus/client_golang/prometheus"
    "github.com/prometheus/client_golang/prometheus/promauto"
)

type BusinessMetrics struct {
    // è®¾å¤‡çŠ¶æ€æŒ‡æ ‡
    DeviceTotalCount     prometheus.Gauge
    DeviceOnlineCount    prometheus.Gauge
    DeviceOfflineCount   prometheus.Gauge
    DeviceOnlineRate     prometheus.Gauge
    
    // ç«¯å£ä½¿ç”¨æŒ‡æ ‡
    PortTotalCount       prometheus.Gauge
    PortIdleCount        prometheus.Gauge
    PortChargingCount    prometheus.Gauge
    PortFaultCount       prometheus.Gauge
    PortUtilizationRate  prometheus.Gauge
    
    // å……ç”µä¸šåŠ¡æŒ‡æ ‡
    ChargingSessionsActive     prometheus.Gauge
    ChargingSessionsTotal      prometheus.Counter
    ChargingSuccessTotal       prometheus.Counter
    ChargingFailureTotal       prometheus.Counter
    ChargingDuration          prometheus.Histogram
    
    // èƒ½è€—æŒ‡æ ‡
    EnergyConsumedTotal       prometheus.Counter
    PowerOutputCurrent        prometheus.Gauge
    PowerAverage              prometheus.Gauge
    
    // APIæœåŠ¡æŒ‡æ ‡
    APIRequestsTotal          prometheus.CounterVec
    APIRequestDuration        prometheus.HistogramVec
    APIErrorsTotal            prometheus.CounterVec
    
    // äº‹ä»¶æ¨é€æŒ‡æ ‡
    WebhookPushTotal          prometheus.CounterVec
    WebhookLatency            prometheus.Histogram
    WebhookRetryTotal         prometheus.Counter
}

func NewBusinessMetrics() *BusinessMetrics {
    return &BusinessMetrics{
        DeviceTotalCount: promauto.NewGauge(prometheus.GaugeOpts{
            Name: "iot_device_total_count",
            Help: "Total number of devices",
        }),
        
        DeviceOnlineCount: promauto.NewGauge(prometheus.GaugeOpts{
            Name: "iot_device_online_count",
            Help: "Number of online devices",
        }),
        
        DeviceOnlineRate: promauto.NewGauge(prometheus.GaugeOpts{
            Name: "iot_device_online_rate",
            Help: "Device online rate (0-1)",
        }),
        
        PortUtilizationRate: promauto.NewGauge(prometheus.GaugeOpts{
            Name: "iot_port_utilization_rate",
            Help: "Port utilization rate (0-1)",
        }),
        
        ChargingSessionsActive: promauto.NewGauge(prometheus.GaugeOpts{
            Name: "iot_charging_sessions_active",
            Help: "Number of active charging sessions",
        }),
        
        ChargingDuration: promauto.NewHistogram(prometheus.HistogramOpts{
            Name:    "iot_charging_duration_minutes",
            Help:    "Charging session duration in minutes",
            Buckets: []float64{5, 10, 15, 30, 60, 120, 240, 480},
        }),
        
        APIRequestsTotal: promauto.NewCounterVec(
            prometheus.CounterOpts{
                Name: "iot_api_requests_total",
                Help: "Total number of API requests",
            },
            []string{"method", "endpoint", "client_id", "status_code"},
        ),
        
        APIRequestDuration: promauto.NewHistogramVec(
            prometheus.HistogramOpts{
                Name:    "iot_api_request_duration_milliseconds",
                Help:    "API request duration in milliseconds",
                Buckets: []float64{1, 5, 10, 25, 50, 100, 250, 500, 1000, 2500},
            },
            []string{"method", "endpoint"},
        ),
        
        WebhookPushTotal: promauto.NewCounterVec(
            prometheus.CounterOpts{
                Name: "iot_webhook_push_total",
                Help: "Total number of webhook pushes",
            },
            []string{"event_type", "status"},
        ),
        
        WebhookLatency: promauto.NewHistogram(prometheus.HistogramOpts{
            Name:    "iot_webhook_latency_milliseconds",
            Help:    "Webhook push latency in milliseconds",
            Buckets: []float64{10, 50, 100, 500, 1000, 2000, 5000},
        }),
    }
}

// è®¾å¤‡çŠ¶æ€æ›´æ–°æ–¹æ³•
func (m *BusinessMetrics) UpdateDeviceStats(total, online, offline int) {
    m.DeviceTotalCount.Set(float64(total))
    m.DeviceOnlineCount.Set(float64(online))
    m.DeviceOfflineCount.Set(float64(offline))
    
    if total > 0 {
        m.DeviceOnlineRate.Set(float64(online) / float64(total))
    }
}

// ç«¯å£çŠ¶æ€æ›´æ–°æ–¹æ³•
func (m *BusinessMetrics) UpdatePortStats(total, idle, charging, fault int) {
    m.PortTotalCount.Set(float64(total))
    m.PortIdleCount.Set(float64(idle))
    m.PortChargingCount.Set(float64(charging))
    m.PortFaultCount.Set(float64(fault))
    
    if total > 0 {
        m.PortUtilizationRate.Set(float64(charging) / float64(total))
    }
}

// APIè¯·æ±‚è®°å½•æ–¹æ³•
func (m *BusinessMetrics) RecordAPIRequest(method, endpoint, clientID, statusCode string, duration float64) {
    m.APIRequestsTotal.WithLabelValues(method, endpoint, clientID, statusCode).Inc()
    m.APIRequestDuration.WithLabelValues(method, endpoint).Observe(duration)
}

// å……ç”µä¼šè¯è®°å½•æ–¹æ³•
func (m *BusinessMetrics) RecordChargingSession(success bool, duration float64) {
    m.ChargingSessionsTotal.Inc()
    if success {
        m.ChargingSuccessTotal.Inc()
    } else {
        m.ChargingFailureTotal.Inc()
    }
    m.ChargingDuration.Observe(duration)
}

// Webhookæ¨é€è®°å½•æ–¹æ³•
func (m *BusinessMetrics) RecordWebhookPush(eventType, status string, latency float64) {
    m.WebhookPushTotal.WithLabelValues(eventType, status).Inc()
    m.WebhookLatency.Observe(latency)
}
```

### 2. æŒ‡æ ‡æ”¶é›†å™¨
```go
// internal/metrics/collector.go
package metrics

import (
    "context"
    "time"
    
    "go.uber.org/zap"
)

type MetricsCollector struct {
    logger   *zap.Logger
    repo     Repository
    session  SessionManager
    metrics  *BusinessMetrics
    interval time.Duration
}

func NewMetricsCollector(logger *zap.Logger, repo Repository, session SessionManager, metrics *BusinessMetrics) *MetricsCollector {
    return &MetricsCollector{
        logger:   logger,
        repo:     repo,
        session:  session,
        metrics:  metrics,
        interval: 30 * time.Second, // 30ç§’æ”¶é›†ä¸€æ¬¡
    }
}

func (c *MetricsCollector) Start(ctx context.Context) {
    ticker := time.NewTicker(c.interval)
    defer ticker.Stop()
    
    for {
        select {
        case <-ctx.Done():
            return
        case <-ticker.C:
            c.collectMetrics(ctx)
        }
    }
}

func (c *MetricsCollector) collectMetrics(ctx context.Context) {
    // æ”¶é›†è®¾å¤‡çŠ¶æ€æŒ‡æ ‡
    deviceStats, err := c.repo.GetDeviceStats(ctx)
    if err != nil {
        c.logger.Error("failed to get device stats", zap.Error(err))
    } else {
        c.metrics.UpdateDeviceStats(
            deviceStats.Total,
            deviceStats.Online,
            deviceStats.Offline,
        )
    }
    
    // æ”¶é›†ç«¯å£çŠ¶æ€æŒ‡æ ‡
    portStats, err := c.repo.GetPortStats(ctx)
    if err != nil {
        c.logger.Error("failed to get port stats", zap.Error(err))
    } else {
        c.metrics.UpdatePortStats(
            portStats.Total,
            portStats.Idle,
            portStats.Charging,
            portStats.Fault,
        )
    }
    
    // æ”¶é›†å……ç”µä¼šè¯æŒ‡æ ‡
    sessionStats, err := c.repo.GetChargingSessionStats(ctx)
    if err != nil {
        c.logger.Error("failed to get charging session stats", zap.Error(err))
    } else {
        c.metrics.ChargingSessionsActive.Set(float64(sessionStats.Active))
    }
    
    // æ”¶é›†èƒ½è€—æŒ‡æ ‡
    powerStats, err := c.repo.GetPowerStats(ctx)
    if err != nil {
        c.logger.Error("failed to get power stats", zap.Error(err))
    } else {
        c.metrics.PowerOutputCurrent.Set(powerStats.CurrentTotal)
        c.metrics.PowerAverage.Set(powerStats.Average)
    }
}
```

### 3. å‘Šè­¦è§„åˆ™é…ç½®
```yaml
# monitoring/alerting_rules.yml
groups:
  - name: iot_device_alerts
    rules:
      - alert: DeviceOfflineRateHigh
        expr: iot_device_online_rate < 0.95
        for: 5m
        labels:
          severity: warning
          category: device
        annotations:
          summary: "è®¾å¤‡ç¦»çº¿ç‡è¿‡é«˜"
          description: "è®¾å¤‡åœ¨çº¿ç‡ä¸º {{ $value | humanizePercentage }}ï¼Œä½äº95%é˜ˆå€¼"
          
      - alert: DeviceOfflineRateCritical
        expr: iot_device_online_rate < 0.9
        for: 2m
        labels:
          severity: critical
          category: device
        annotations:
          summary: "è®¾å¤‡ç¦»çº¿ç‡ä¸¥é‡å¼‚å¸¸"
          description: "è®¾å¤‡åœ¨çº¿ç‡ä¸º {{ $value | humanizePercentage }}ï¼Œä½äº90%é˜ˆå€¼"

  - name: iot_charging_alerts
    rules:
      - alert: ChargingSuccessRateLow
        expr: rate(iot_charging_success_total[5m]) / rate(iot_charging_sessions_total[5m]) < 0.95
        for: 10m
        labels:
          severity: warning
          category: business
        annotations:
          summary: "å……ç”µæˆåŠŸç‡è¿‡ä½"
          description: "æœ€è¿‘5åˆ†é’Ÿå……ç”µæˆåŠŸç‡ä¸º {{ $value | humanizePercentage }}"
          
      - alert: PortUtilizationLow
        expr: iot_port_utilization_rate < 0.1
        for: 30m
        labels:
          severity: info
          category: operation
        annotations:
          summary: "ç«¯å£åˆ©ç”¨ç‡è¿‡ä½"
          description: "ç«¯å£åˆ©ç”¨ç‡ä¸º {{ $value | humanizePercentage }}ï¼Œå¯èƒ½éœ€è¦è¿è¥è°ƒæ•´"

  - name: iot_api_alerts
    rules:
      - alert: APIResponseTimeHigh
        expr: histogram_quantile(0.95, rate(iot_api_request_duration_milliseconds_bucket[5m])) > 100
        for: 5m
        labels:
          severity: warning
          category: performance
        annotations:
          summary: "APIå“åº”æ—¶é—´è¿‡é«˜"
          description: "API P95å“åº”æ—¶é—´ä¸º {{ $value }}msï¼Œè¶…è¿‡100msé˜ˆå€¼"
          
      - alert: APIErrorRateHigh
        expr: rate(iot_api_requests_total{status_code=~"5.."}[5m]) / rate(iot_api_requests_total[5m]) > 0.01
        for: 5m
        labels:
          severity: critical
          category: availability
        annotations:
          summary: "APIé”™è¯¯ç‡è¿‡é«˜"
          description: "API 5xxé”™è¯¯ç‡ä¸º {{ $value | humanizePercentage }}"

  - name: iot_webhook_alerts
    rules:
      - alert: WebhookPushFailureRateHigh
        expr: rate(iot_webhook_push_total{status="failed"}[5m]) / rate(iot_webhook_push_total[5m]) > 0.05
        for: 10m
        labels:
          severity: warning
          category: integration
        annotations:
          summary: "äº‹ä»¶æ¨é€å¤±è´¥ç‡è¿‡é«˜"
          description: "äº‹ä»¶æ¨é€å¤±è´¥ç‡ä¸º {{ $value | humanizePercentage }}"
```

### 4. Grafana Dashboardé…ç½®
```json
{
  "dashboard": {
    "id": null,
    "title": "IoTå……ç”µæ¡©ä¸­é—´ä»¶ç›‘æ§",
    "tags": ["iot", "charging"],
    "timezone": "Asia/Shanghai",
    "panels": [
      {
        "title": "è®¾å¤‡çŠ¶æ€æ€»è§ˆ",
        "type": "stat",
        "targets": [
          {
            "expr": "iot_device_total_count",
            "legendFormat": "è®¾å¤‡æ€»æ•°"
          },
          {
            "expr": "iot_device_online_count",
            "legendFormat": "åœ¨çº¿è®¾å¤‡"
          },
          {
            "expr": "iot_device_online_rate",
            "legendFormat": "åœ¨çº¿ç‡"
          }
        ],
        "fieldConfig": {
          "defaults": {
            "unit": "short",
            "color": {
              "mode": "thresholds"
            },
            "thresholds": {
              "steps": [
                {"color": "red", "value": 0},
                {"color": "yellow", "value": 0.9},
                {"color": "green", "value": 0.95}
              ]
            }
          }
        }
      },
      {
        "title": "ç«¯å£ä½¿ç”¨æƒ…å†µ",
        "type": "piechart",
        "targets": [
          {
            "expr": "iot_port_idle_count",
            "legendFormat": "ç©ºé—²ç«¯å£"
          },
          {
            "expr": "iot_port_charging_count",
            "legendFormat": "å……ç”µä¸­"
          },
          {
            "expr": "iot_port_fault_count",
            "legendFormat": "æ•…éšœç«¯å£"
          }
        ]
      },
      {
        "title": "APIæ€§èƒ½ç›‘æ§",
        "type": "graph",
        "targets": [
          {
            "expr": "histogram_quantile(0.95, rate(iot_api_request_duration_milliseconds_bucket[5m]))",
            "legendFormat": "P95å“åº”æ—¶é—´"
          },
          {
            "expr": "histogram_quantile(0.99, rate(iot_api_request_duration_milliseconds_bucket[5m]))",
            "legendFormat": "P99å“åº”æ—¶é—´"
          }
        ],
        "yAxes": [
          {
            "unit": "ms",
            "label": "å“åº”æ—¶é—´"
          }
        ]
      },
      {
        "title": "å……ç”µä¸šåŠ¡æŒ‡æ ‡",
        "type": "graph",
        "targets": [
          {
            "expr": "iot_charging_sessions_active",
            "legendFormat": "æ´»è·ƒä¼šè¯"
          },
          {
            "expr": "rate(iot_charging_sessions_total[5m]) * 60",
            "legendFormat": "æ¯åˆ†é’Ÿæ–°å¢ä¼šè¯"
          },
          {
            "expr": "rate(iot_charging_success_total[5m]) / rate(iot_charging_sessions_total[5m])",
            "legendFormat": "æˆåŠŸç‡"
          }
        ]
      }
    ],
    "time": {
      "from": "now-1h",
      "to": "now"
    },
    "refresh": "30s"
  }
}
```

## ğŸš¨ å‘Šè­¦é€šçŸ¥æ–¹æ¡ˆ

### 1. å‘Šè­¦åˆ†çº§
```yaml
å‘Šè­¦çº§åˆ«:
  - critical: ç«‹å³å¤„ç†ï¼Œå½±å“æœåŠ¡å¯ç”¨æ€§
  - warning: éœ€è¦å…³æ³¨ï¼Œå¯èƒ½å½±å“æœåŠ¡è´¨é‡  
  - info: ä¿¡æ¯æé†’ï¼Œç”¨äºè¿è¥ä¼˜åŒ–

é€šçŸ¥ç­–ç•¥:
  critical:
    - ç«‹å³é€šçŸ¥: SMS + ç”µè¯ + ä¼ä¸šå¾®ä¿¡
    - å‡çº§æœºåˆ¶: 10åˆ†é’Ÿæ— å“åº”å‡çº§åˆ°ä¸»ç®¡
    - é€šçŸ¥é¢‘ç‡: æ¯5åˆ†é’Ÿé‡å¤é€šçŸ¥ç›´åˆ°ç¡®è®¤
    
  warning:
    - æ­£å¸¸é€šçŸ¥: ä¼ä¸šå¾®ä¿¡ + é‚®ä»¶
    - å‡çº§æœºåˆ¶: 30åˆ†é’Ÿæ— å“åº”å‡çº§
    - é€šçŸ¥é¢‘ç‡: æ¯15åˆ†é’Ÿé‡å¤é€šçŸ¥
    
  info:
    - å»¶è¿Ÿé€šçŸ¥: é‚®ä»¶é€šçŸ¥ï¼Œæ¯æ—¥æ±‡æ€»
    - æ— å‡çº§æœºåˆ¶
```

### 2. å‘Šè­¦æŠ‘åˆ¶è§„åˆ™
```yaml
æŠ‘åˆ¶è§„åˆ™:
  - ç»´æŠ¤çª—å£æœŸé—´æŠ‘åˆ¶æ‰€æœ‰å‘Šè­¦
  - è®¾å¤‡ç¦»çº¿æ—¶æŠ‘åˆ¶è¯¥è®¾å¤‡çš„å…¶ä»–å‘Šè­¦
  - åŒç±»å‹å‘Šè­¦åœ¨5åˆ†é’Ÿå†…åªå‘é€ä¸€æ¬¡
  - ç³»ç»Ÿé‡å¯æœŸé—´æŠ‘åˆ¶å¯åŠ¨ç›¸å…³å‘Šè­¦
  
é™é»˜è§„åˆ™:
  - é¢„æœŸç»´æŠ¤æ“ä½œå‰å¯æ‰‹åŠ¨é™é»˜
  - å·²çŸ¥é—®é¢˜å¯ä¸´æ—¶é™é»˜
  - è¯¯æŠ¥å‘Šè­¦å¯æ·»åŠ æ°¸ä¹…é™é»˜
```

## ğŸ“ˆ æ•°æ®åˆ†æå’ŒæŠ¥è¡¨

### 1. æ—¥å¸¸è¿è¥æŠ¥è¡¨
```yaml
æ¯æ—¥æŠ¥è¡¨:
  - è®¾å¤‡åœ¨çº¿ç‡è¶‹åŠ¿
  - å……ç”µä¸šåŠ¡é‡ç»Ÿè®¡
  - APIè°ƒç”¨é‡åˆ†æ
  - å¼‚å¸¸äº‹ä»¶æ±‡æ€»
  
æ¯å‘¨æŠ¥è¡¨:
  - è®¾å¤‡å¥åº·åº¦è¯„ä¼°
  - æ€§èƒ½è¶‹åŠ¿åˆ†æ
  - å®¹é‡ä½¿ç”¨æƒ…å†µ
  - é—®é¢˜æ ¹å› åˆ†æ
  
æ¯æœˆæŠ¥è¡¨:
  - ä¸šåŠ¡å¢é•¿åˆ†æ
  - ç³»ç»Ÿä¼˜åŒ–å»ºè®®
  - å®¹é‡è§„åˆ’å»ºè®®
  - æˆæœ¬æ•ˆç›Šåˆ†æ
```

### 2. æ•°æ®ä¿ç•™ç­–ç•¥
```yaml
æŒ‡æ ‡æ•°æ®ä¿ç•™:
  - é«˜ç²¾åº¦æ•°æ®(15s): ä¿ç•™7å¤©
  - ä¸­ç²¾åº¦æ•°æ®(5m): ä¿ç•™30å¤©  
  - ä½ç²¾åº¦æ•°æ®(1h): ä¿ç•™1å¹´
  - èšåˆæ•°æ®(1d): æ°¸ä¹…ä¿ç•™
  
æ—¥å¿—æ•°æ®ä¿ç•™:
  - APIè®¿é—®æ—¥å¿—: ä¿ç•™30å¤©
  - é”™è¯¯æ—¥å¿—: ä¿ç•™90å¤©
  - å®¡è®¡æ—¥å¿—: ä¿ç•™1å¹´
  - å‘Šè­¦å†å²: æ°¸ä¹…ä¿ç•™
```

## ğŸ¯ å®æ–½è®¡åˆ’

### Week 1: åŸºç¡€æŒ‡æ ‡
- [ ] å®ç°åŸºç¡€ä¸šåŠ¡æŒ‡æ ‡æ”¶é›†
- [ ] é…ç½®Prometheusç›‘æ§
- [ ] åˆ›å»ºåŸºç¡€Grafana Dashboard

### Week 2: å‘Šè­¦é…ç½®
- [ ] é…ç½®å…³é”®å‘Šè­¦è§„åˆ™
- [ ] é›†æˆé€šçŸ¥æ¸ é“
- [ ] æµ‹è¯•å‘Šè­¦æµç¨‹

### Week 3: å®Œå–„ç›‘æ§
- [ ] æ·»åŠ é«˜çº§ä¸šåŠ¡æŒ‡æ ‡
- [ ] ä¼˜åŒ–Dashboardå¸ƒå±€
- [ ] å®ç°è‡ªåŠ¨åŒ–æŠ¥è¡¨

### Week 4: ä¼˜åŒ–è¿ç»´
- [ ] åˆ†æå†å²æ•°æ®åˆ¶å®šåŸºçº¿
- [ ] ä¼˜åŒ–å‘Šè­¦é˜ˆå€¼
- [ ] å»ºç«‹è¿ç»´æ‰‹å†Œ

---

è¿™ä¸ªç›‘æ§æ–¹æ¡ˆå°†ä¸ºIoTä¸­é—´ä»¶æä¾›å…¨æ–¹ä½çš„è§‚æµ‹èƒ½åŠ›ï¼Œå¸®åŠ©åŠæ—¶å‘ç°é—®é¢˜ã€ä¼˜åŒ–æ€§èƒ½ã€æ”¯æ’‘ä¸šåŠ¡å†³ç­–ã€‚