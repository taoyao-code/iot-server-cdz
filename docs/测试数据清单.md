# 服务端协议测试准备

## 数据来源

- `protocol-validation-test/testdata/scenarios/basic/*.yaml`
- `protocol-validation-test/testdata/scenarios/advanced/*.yaml`
- `protocol-validation-test/testdata/scenarios/validation/*.yaml`
- 真实设备抓包/日志（待确认）

## 目标目录

- `internal/protocol/bkv/testdata/`
- `internal/protocol/gn/testdata/`
- `internal/protocol/ap3000/testdata/`

## 报文整理清单

| 协议 | 场景 | 来源文件 | 样本文件 | 校验备注 |
| ---- | ---- | -------- | -------- | -------- |
| BKV  | 心跳上行 (`heartbeat_uplink_001`) | `basic/heartbeat.yaml` | `internal/protocol/bkv/testdata/heartbeat_uplink_001.hex` | 待校验长度/校验和 |
| BKV  | 心跳下行 (`heartbeat_downlink_001`) | `basic/heartbeat.yaml` | `internal/protocol/bkv/testdata/heartbeat_downlink_001.hex` | 待校验 |
| BKV  | 控制按时 (`control_time_charging_001`) | `basic/charging_control.yaml` | `internal/protocol/bkv/testdata/control_time_charging_001.hex` | 原样例校验和疑似占位，需重算 |
| BKV  | 控制按量 (`control_power_charging_001`) | `basic/charging_control.yaml` | `internal/protocol/bkv/testdata/control_power_charging_001.hex` | 同上 |
| BKV  | 充电结束 (`charging_end_time_001`) | `advanced/charging_end.yaml` | `internal/protocol/bkv/testdata/charging_end_time_001.hex` | 待校验 |
| BKV  | 充电结束功率 (`charging_end_power_001`) | `advanced/charging_end.yaml` | `internal/protocol/bkv/testdata/charging_end_power_001.hex` | 待校验 |
| BKV  | 充电结束费用 (`charging_end_fee_service_001`) | `advanced/charging_end.yaml` | `internal/protocol/bkv/testdata/charging_end_fee_service_001.hex` | 待校验 |
| BKV  | 校验和正确 (`checksum_valid_001`) | `validation/checksum_validation.yaml` | `internal/protocol/bkv/testdata/checksum_valid_001.hex` | 样例校验和为 0x00，需重算 |
| BKV  | 校验和错误 (`checksum_invalid_001`) | 同上 | `internal/protocol/bkv/testdata/checksum_invalid_001.hex` | 保留错误帧用于负例 |
| GN   | 状态上报/控制等 | 待从 GN 场景提取 | TBD | TBD |
| AP3000 | 心跳/参数 | 待确认 | TBD | TBD |

> 状态：以上样本尚未复制/校验，仅列出整理计划。准备阶段完成后，将逐条生成 `.hex` 文件并记录校验结果。
